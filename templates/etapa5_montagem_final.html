{% extends "layout.html" %}
{% block content %}
    <h1>Etapa 5: Montagem do V√≠deo Final</h1>

    <!-- Sec√ß√£o de Gerenciamento dos V√≠deos Base -->
    <div class="status {% if status.videos_base %}completo{% else %}pendente{% endif %}" style="margin-bottom: 2em;">
        <h3>V√≠deos Base Dispon√≠veis ({{ status.videos_base|length }})</h3>
        {% if status.videos_base %}
            <p>Estes s√£o os clipes que ser√£o usados na montagem final. Voc√™ pode remover os que n√£o desejar.</p>
            
            <form action="{{ url_for('excluir', etapa='videos_base') }}" method="post">
                <div style="max-height: 200px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; margin-bottom: 10px;">
                {% for video in status.videos_base %}
                    <label><input type="checkbox" name="arquivos_selecionados" value="{{ video }}"> {{ video }}</label><br>
                {% endfor %}
                </div>
                <button type="submit" name="action" value="delete_selected" onclick="return confirm('Tem certeza que deseja excluir os v√≠deos selecionados?')" style="background-color: #dc3545; color: white;">Excluir Selecionados</button>
                <button type="submit" name="action" value="delete_all" onclick="return confirm('ATEN√á√ÉO: Isso excluir√° TODOS os v√≠deos base. Tem certeza?')" style="background-color: #6c757d; color: white;">Excluir Todos</button>
            </form>
        {% else %}
            <p>Nenhum v√≠deo base encontrado. Volte para a Etapa 4 para ger√°-los.</p>
        {% endif %}
    </div>

    <!-- Sec√ß√£o de Montagem do V√≠deo Final -->
    {% if status.video_final %}
        <!-- ... (c√≥digo para mostrar o v√≠deo final) ... -->
    {% else %}
        {% if status.videos_base and status.narracao %}
        <div class="status pendente">
            <p>Todos os componentes est√£o prontos para a montagem final.</p>
            <form action="{{ url_for('etapa5_montagem_final') }}" method="post">
                <!-- LINHA ADICIONADA -->
                <input type="hidden" name="action" value="montar_video">
                <button type="submit" style="padding: 15px; font-size: 16px;">
                    üöÄ Montar V√≠deo Final
                </button>
            </form>
        </div>
        {% endif %}
    {% endif %}
{% endblock %}
